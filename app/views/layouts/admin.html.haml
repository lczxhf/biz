# coding: UTF-8

!!!
%html{lang: "zh-CN"}
  %head
    %meta{:content => "text/html; charset=UTF-8", "http-equiv" => "Content-Type"}
    %meta{:content => "IE=edge,chrome=1", "http-equiv" => "X-UA-Compatible"}
    %meta{:charset => "utf-8"}
    %title 灵墨-Mall
    %meta{:content => "", :name => "description"}
    %meta{:content => "width=device-width, initial-scale=1.0, maximum-scale=1.0", :name => "viewport"}
    
    %link{:href => "/assets/css/bootstrap.min.css", :rel => "stylesheet"}
    %link{:href => "/assets/font-awesome/4.2.0/css/font-awesome.min.css", :rel => "stylesheet"}    
    %link{:href => "/assets/css/jquery-ui.custom.min.css", :rel => "stylesheet"}
    %link{:href => "/assets/css/chosen.min.css", :rel => "stylesheet"}
    %link{:href => "/assets/css/datepicker.min.css", :rel => "stylesheet"}
    %link{:href => "/assets/css/bootstrap-timepicker.min.css", :rel => "stylesheet"}
    %link{:href => "/assets/css/daterangepicker.min.css", :rel => "stylesheet"}
    %link{:href => "/assets/css/bootstrap-datetimepicker.min.css", :rel => "stylesheet"}
    %link{:href => "/assets/css/colorpicker.min.css", :rel => "stylesheet"}    
    %link{:href => "/assets/fonts/fonts.googleapis.com.css", :rel => "stylesheet"}

    %link{:href => "/assets/css/dropzone.min.css", :rel => "stylesheet"}
    %link{:href => "/assets/css/colorbox.min.css", :rel => "stylesheet"}
    %link{:href => "/assets/css/ace.min.css", :rel => "stylesheet"}    

    = stylesheet_link_tag "application"   

    = stylesheet_link_tag "normal"
    = stylesheet_link_tag "ui-dialog"    
    
    / # = stylesheet_link_tag "application", params[:controller], :media => "all"
    / # = javascript_include_tag "application", params[:controller]

    /[if lte IE 9]
      <link rel="stylesheet" href="/assets/css/ace-part2.min.css" class="ace-main-stylesheet" />
    /[if lte IE 9]
      <link rel="stylesheet" href="/assets/css/ace-ie.min.css" />
    / inline styles related to this page
    / ace settings handler
    %script{:src => "/assets/js/ace-extra.min.js"}
    / HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries
    /[if lte IE 8]
      <script src="/assets/js/html5shiv.min.js"></script>
      <script src="/assets/js/respond.min.js"></script>

    / [if !IE]>
    / %script{:src => "/assets/js/jquery.2.1.1.min.js"}
    / <![endif]
    /[if IE]
      / <script src="/assets/js/jquery.1.11.1.min.js"></script>
    / [if !IE]>
    :javascript
      window.jQuery || document.write("<script src='/assets/js/jquery.min.js'>"+"<"+"/script>");
    / <![endif]
    /[if IE]
      <script type="text/javascript">
      window.jQuery || document.write("<script src='/assets/js/jquery1x.min.js'>"+"<"+"/script>");
      </script>
    :javascript
      if('ontouchstart' in document.documentElement) document.write("<script src='/assets/js/jquery.mobile.custom.min.js'>"+"<"+"/script>");
    %script{:src => "/assets/js/bootstrap.min.js"}
    
    %script{:src => "/assets/js/bootbox.min.js"}

    = javascript_include_tag "application", params[:controller]
    = javascript_include_tag "jquery.autocomplete"     
    = javascript_include_tag "jquery.print"     
    = javascript_include_tag "ui-dialog"     
    

    / page specific plugin scripts
    /[if lte IE 8]
    %script{:src => "/assets/js/excanvas.min.js"}
    %script{:src => "/assets/js/jquery-ui.custom.min.js"}
    %script{:src => "/assets/js/jquery.ui.touch-punch.min.js"}
    %script{:src => "/assets/js/chosen.jquery.min.js"}
    %script{:src => "/assets/js/fuelux.spinner.min.js"}
    %script{:src => "/assets/js/bootstrap-datepicker.min.js"}
    %script{:src => "/assets/js/bootstrap-timepicker.min.js"}
    %script{:src => "/assets/js/moment.min.js"}
    %script{:src => "/assets/js/daterangepicker.min.js"}
    %script{:src => "/assets/js/bootstrap-datetimepicker.min.js"}
    %script{:src => "/assets/js/bootstrap-colorpicker.min.js"}
    %script{:src => "/assets/js/jquery.knob.min.js"}
    %script{:src => "/assets/js/jquery.autosize.min.js"}
    %script{:src => "/assets/js/jquery.inputlimiter.1.3.1.min.js"}
    %script{:src => "/assets/js/jquery.maskedinput.min.js"}
    %script{:src => "/assets/js/bootstrap-tag.min.js"}    
    / ace scripts
    %script{:src => "/assets/js/ace-elements.min.js"}
    %script{:src => "/assets/js/ace.min.js"}        

    %script{:src => "/assets/js/jquery.dataTables.min.js"}
    %script{:src => "/assets/js/jquery.dataTables.bootstrap.min.js"}
    %script{:src => "/assets/js/dataTables.tableTools.min.js"}
    %script{:src => "/assets/js/dataTables.colVis.min.js"}

    %script{src:"/assets/js/ace-extra.min.js"}  
    %script{src:"/assets/js/jquery.nestable.min.js"}       
    %script{src: "http://api.map.baidu.com/api?v=2.0&ak=CwSGsPMUcewm0GD59ClzqZmz"} 


    %link{:href => "/libs/My97DatePicker/skin/WdatePicker.css", :rel => "stylesheet"}        
    %link{:href => "/libs/My97DatePicker/skin/whyGreen/datepicker.css", :rel => "stylesheet"}    
    %script{:src => "/libs/My97DatePicker/WdatePicker.js"}
    
    = csrf_meta_tag    

  %body.no-skin
    .navbar.navbar.navbar-default
      :javascript
        try{ace.settings.check('navbar' , 'fixed')}catch(e){}
      .navbar-container.navbar-container
        %button#menu-toggler.navbar-toggle.menu-toggler.pull-left{"data-target" => "#sidebar", :type => "button"}
          %span.sr-only Toggle sidebar
          %span.icon-bar
          %span.icon-bar
          %span.icon-bar
        .navbar-header.pull-left
          %a.navbar-brand{:href => "/"}
            %small
              %i.fa.fa-leaf
              Lmo Mall
        .navbar-buttons.navbar-header.pull-right{:role => "navigation"}
          %ul.nav.ace-nav        
            - notices = Notice.where(admin_user: @admin_user, read:false)   
            - if notices.count == 0
              %li.green.hide
            - else
              %li.green
                %a.dropdown-toggle{"data-toggle" => "dropdown", :href => "#"}
                  %i.ace-icon.fa.fa-bell.icon-animated-bell
                  %span.badge.badge-important
                    = notices.count

                %ul.dropdown-menu-right.dropdown-navbar.navbar-pink.dropdown-menu.dropdown-caret.dropdown-close
                  %li.dropdown-header
                    %i.ace-icon.fa.fa-envelope
                    = "#{notices.count} 通知" 
                  %li.dropdown-content
                    %ul.dropdown-menu.dropdown-navbar.navbar-pink
                      - notices.limit(6).each do |notice|
                        %li
                          %a{:href => "/admin/notice/#{notice.id}"}
                            .clearfix
                              %span.pull-left
                                %i.btn.btn-xs.no-hover.btn-pink.fa.fa-comment
                                = notice.get_display :event_type
                              %span.pull-right.badge.badge-info 
                                = "+ #{notice.event_count}"
                         
                  %li.dropdown-footer
                    %a{:href => "/admin/notice"}
                      查看所有通知
                      %i.ace-icon.fa.fa-arrow-right
            
            %li.light-blue
              %a.dropdown-toggle{"data-toggle" => "dropdown", :href => "#"}
                %img.nav-user-photo{:alt => "tommy Photo", :src => "/assets/images/logo.png"}/
                %span.user-info
                  %small 欢迎,
                  =@admin_user.username if @admin_user
                %i.ace-icon.fa.fa-caret-down
              %ul.user-menu.dropdown-menu-right.dropdown-menu.dropdown-yellow.dropdown-caret.dropdown-close
                %li
                  %a{:href => "#{ace_path @admin_user, :edit}"}
                    %i.ace-icon.fa.fa-cog
                    账号设置                
                %li.divider
                %li
                  %a{:href => "#{destroy_admin_user_session_path}"}
                    %i.ace-icon.fa.fa-power-off
                    登出
                

      / /.navbar-container
    #main-container.main-container
      :javascript
        try{ace.settings.check('main-container' , 'fixed')}catch(e){}
      
      = render '/partials/sidebar'

      .main-content
        .main-content-inner
          #breadcrumbs.breadcrumbs
            :javascript
              try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}

            %ul.breadcrumb
              %li
                %i.ace-icon.fa.fa-home.home-icon
                %a{:href => "/admin/dash_board"} Lmo

              - @breadcrumb.each do |item|
                -if @breadcrumb.last == item
                  %li.active
                    %a{:href => "#{item.keys.first}"} 
                      = item.values.first
                -else
                  %li
                    %a{:href => "#{item.keys.first}"} 
                      = item.values.first
            
            .nav-search.nav-search.hide
              %form.form-search
                %span.input-icon
                  %input.nav-search-input.nav-search-input{:autocomplete => "off", :placeholder => "Search ...", :type => "text"}
                  %i.ace-icon.fa.fa-search.nav-search-icon          

          .page-content            
            .row
              .col-xs-12
                = yield

      = render '/partials/footer'
     
            
    %a#btn-scroll-up.btn-scroll-up.btn.btn-sm.btn-inverse{:href => "#"}
      %i.ace-icon.fa.fa-angle-double-up.icon-only.bigger-110   
      
  = javascript_include_tag "cat_select"     

:javascript
    $.ajaxSetup({
        headers: {
          'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content')
        }
      });

- if action_name == "show" and controller_name != "order"
  :javascript      
    $("input").attr("readonly", true);    
    $("input").attr("disabled", "disabled");
    $("textarea").attr("readonly", true);
    $("select").attr("disabled", "disabled");    
    